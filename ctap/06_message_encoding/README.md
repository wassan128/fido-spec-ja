# 6. メッセージエンコーディング
Bluetooth Smartなどの多くのトランスポート層の通信は帯域幅制限があり、環境によってはJSONなどのシリアライゼーションフォーマットでは重すぎることがあります。このため、簡潔なバイナリエンコードができるCBOR(RFC7049)がエンコーディングに使われます。

メッセージの複雑さとパース及びバリデーションで必要なリソースを削減するため、すべてのメッセージは以下に示すCTAP2 canonical CBOR encodingを使う必要があります(MUST)。これはRFC7049の3.9章で定義されているCTAP2 canonical CBOR encoding formの正規化提案とは別物です。全てのエンコーダは重複キーがないようにCTAP2 canonical encoding formの中でCBORをシリアライズする必要があります(MUST)。全てのデコーダはCTAP2 canonical CBOR encoding formに適格でないCBORを弾くべき(SHOULD)であり、また重複キーを持ったメッセージも弾くべきです(SHOULD)。

CTAP2 canonical CBOR encoding formは以下のルールに従います:
* 0から23及び-1から-24はメジャーな型において同じバイトで表現されます
* 24から255及び-25から-256はuint8_tで表現されなければいけません
* 256から65535及び-257から-65536はuint16_tで表現されなければいけません
* 65536から49672957295及び-65537から-49672957296はuint32_tで表現されなければいけません
